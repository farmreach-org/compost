import{u as L,m as j,a5 as Q,I as M,Y as R,o as l,c as h,e as b,S as D,b as s,g as w,w as t,a as e,af as W,aj as X,f as d,t as m,ag as ee,ak as S,cb as O,n as z,N as B,l as V,A as te,ce as q,F as P,r as H,H as se,h as y,d as oe,q as ae,J as re,ad as le,ae as A,Z as ne,i as ce,j as ie,aB as N}from"./app.af17fce1.js";import{u as ue}from"./useSelectable.79aa5ce8.js";import{_ as de}from"./Admin.ea7882ea.js";import{_ as me}from"./PageHeader.fa50e47e.js";import{_ as pe}from"./PureDangerButton.27630a26.js";import{_ as fe}from"./Panel.46137120.js";import{_ as E}from"./Checkbox.6f71d79b.js";import{_ as c,a as J,T as _e}from"./TableCell.387d3662.js";import{_ as ke}from"./SelectableBar.4086aab5.js";import{_ as we}from"./NoResult.ab0b21a6.js";import{T as Y}from"./Trash.ee5d54c5.js";import{_ as he}from"./Pagination.e1cebd0e.js";import{_ as F}from"./PureButtonLink.dbcc593f.js";import{E as ge}from"./Eye.bfdd90d4.js";import{_ as $e}from"./DropdownButton.19db68d6.js";import{A as ve}from"./ArrowTopRightOnSquare.170f472d.js";import{_ as be}from"./SearchInput.1d1bce1a.js";import{_ as ye}from"./Alert.4b0fccab.js";import{_ as xe}from"./Flex.16a0de6f.js";import"./QueueList.3a1b730e.js";import"./ChevronLeft.bc8c49ce.js";import"./EllipsisVertical.42e3e8f4.js";const Ce={class:"flex flex-row items-center justify-end gap-xs"},Ie={__name:"WorkspaceItemAction",props:{itemId:{type:String,required:!0}},emits:["onDelete"],setup(o,{emit:p}){const a=o,{t:r}=L(),i=j("routePrefix"),x=j("confirmation"),{notify:$}=z();Q();const _=M(!1),f=()=>{x().title(r("workspace.delete_workspace")).description(r("workspace.confirm_delete_workspace")).destructive().onConfirm(u=>{u.isLoading(!0),S.delete(route(`${i}.workspaces.delete`,{workspace:a.itemId}),{onSuccess(){_.value=!1,$("success",r("workspace.workspace_deleted")),p("onDelete"),O.emit("workspaceDelete",a.itemId),u.reset()},onFinish(){u.isLoading(!1)}})}).show()};return(u,C)=>{const v=R("tooltip");return l(),h("div",null,[b("div",Ce,[D((l(),w(F,{href:u.route("mixpost.switchWorkspace",{workspace:o.itemId,redirect:!0}),method:"post",as:"button",type:"button"},{default:t(()=>[e(ve)]),_:1},8,["href"])),[[v,s(r)("general.open")]]),D((l(),w(F,{href:u.route(`${s(i)}.workspaces.view`,{workspace:o.itemId})},{default:t(()=>[e(ge)]),_:1},8,["href"])),[[v,s(r)("general.view")]]),e(ee,{"width-classes":"w-32",placement:"bottom-end"},{trigger:t(()=>[e($e)]),content:t(()=>[e(W,{href:u.route(`${s(i)}.workspaces.edit`,{workspace:o.itemId})},{icon:t(()=>[e(X)]),default:t(()=>[d(" "+m(s(r)("general.edit")),1)]),_:1},8,["href"]),e(W,{onClick:f,as:"button"},{icon:t(()=>[e(Y,{class:"text-red-500"})]),default:t(()=>[d(" "+m(s(r)("general.delete")),1)]),_:1})]),_:1})])])}}},Ve={key:0,class:"flex justify-start"},je={key:0,class:"mt-xs"},De={__name:"WorkspaceItem",props:{item:{type:Object,required:!0}},setup(o){const p=o,a=B(()=>V.exports.sortBy(p.item.users.slice(0,3),"pivot.joined_at")),r=B(()=>p.item.users.slice(3).length);return(i,x)=>{const $=R("tooltip");return l(),w(J,{hoverable:!0},{default:t(()=>[e(c,{class:"w-10"},{default:t(()=>[te(i.$slots,"checkbox")]),_:3}),e(c,null,{default:t(()=>[e(q,{backgroundColor:o.item.hex_color,name:o.item.name,roundedClass:"rounded-lg"},null,8,["backgroundColor","name"])]),_:1}),e(c,null,{default:t(()=>[b("div",null,m(o.item.name),1)]),_:1}),e(c,null,{default:t(()=>[d(m(o.item.created_at),1)]),_:1}),e(c,null,{default:t(()=>[o.item.users.length?(l(),h("div",Ve,[(l(!0),h(P,null,H(s(a),(_,f)=>D((l(),w(q,{key:_.id,name:_.name,class:se([{"-ml-6":f>0},"cursor-default mr-xs last:mr-xs"])},null,8,["name","class"])),[[$,_.name]])),128)),s(r)?(l(),h("div",je," +"+m(s(r)),1)):y("",!0)])):y("",!0)]),_:1}),e(c,null,{default:t(()=>[e(Ie,{itemId:o.item.uuid},null,8,["itemId"])]),_:1})]),_:3})}}},Se={class:"flex items-center"},Oe={__name:"Filters",props:{modelValue:{type:Object,required:!0}},emits:["update:modelValue"],setup(o,{emit:p}){return B(()=>0),(a,r)=>(l(),h("div",Se,[e(be,{modelValue:o.modelValue.keyword,"onUpdate:modelValue":r[0]||(r[0]=i=>o.modelValue.keyword=i),placeholder:a.$t("general.search")},null,8,["modelValue","placeholder"])]))}},Be={class:"w-full mx-auto row-py"},Pe={class:"mt-lg row-px w-full"},Re=["href"],Te={key:1,class:"mt-lg"},Ue=oe({layout:de}),rt=Object.assign(Ue,{__name:"Workspaces",props:{workspaces:{type:Object},filter:{type:Object,default:{}}},setup(o){const p=o,{t:a}=L(),r=j("routePrefix"),i=a("workspace.workspaces"),x=j("confirmation"),{notify:$}=z(),{enterpriseConsole:_}=ae(),{selectedRecords:f,putPageRecords:u,toggleSelectRecordsOnPage:C,deselectRecord:v,deselectAllRecords:T}=ue(),U=()=>p.workspaces.data.map(n=>n.uuid),I=M({keyword:p.filter.keyword});re(()=>{u(U()),O.on("workspaceDelete",n=>{v(n)})}),le(()=>{O.off("workspaceDelete")}),A(()=>p.workspaces.data,()=>{u(U())}),A(()=>V.exports.cloneDeep(I.value),V.exports.throttle(()=>{S.get(route(`${r}.workspaces.index`),V.exports.pickBy(I.value),{preserveState:!0,only:["workspaces","filter"]})},300));const Z=()=>{x().title(a("workspace.delete_workspaces")).description(a("workspace.confirm_delete_workspaces")).destructive().onConfirm(n=>{n.isLoading(!0),S.delete(route(`${r}.workspaces.deleteMultiple`),{data:{workspaces:f.value},preserveScroll:!0,onSuccess(){T(),$("success",a("workspace.workspaces_deleted"))},onFinish(){n.reset()}})}).show()};return(n,g)=>{const G=R("tooltip");return l(),h(P,null,[e(s(ne),{title:s(i)},null,8,["title"]),b("div",Be,[e(me,{title:s(i)},{description:t(()=>[d(m(s(a)("workspace.manage_brands_businesses")),1)]),_:1},8,["title"]),b("div",Pe,[e(ke,{count:s(f).length,onClose:s(T)},{default:t(()=>[D((l(),w(pe,{onClick:Z},{default:t(()=>[e(Y)]),_:1})),[[G,s(a)("general.delete")]])]),_:1},8,["count","onClose"]),s(_).url?(l(),w(ye,{key:0,variant:"warning",closeable:!1,class:"mb-lg"},{default:t(()=>[d(" Manage Workspaces from the "),b("a",{href:`${s(_).url}/workspaces`,class:"link"},"Enterprise Console",8,Re),d(" for more business actions. ")]),_:1})):y("",!0),e(xe,{class:"justify-between"},{default:t(()=>[e(s(ce),{href:n.route(`${s(r)}.workspaces.create`),class:"mb-xs sm:mb-0"},{default:t(()=>[e(ie,null,{default:t(()=>[d(m(s(a)("workspace.create_workspace")),1)]),_:1})]),_:1},8,["href"]),e(Oe,{modelValue:I.value,"onUpdate:modelValue":g[0]||(g[0]=k=>I.value=k)},null,8,["modelValue"])]),_:1}),e(fe,{"with-padding":!1,class:"mt-lg"},{default:t(()=>[e(_e,null,{head:t(()=>[e(J,null,{default:t(()=>[e(c,{component:"th",scope:"col",class:"w-10"},{default:t(()=>[e(E,{checked:s(C),"onUpdate:checked":g[1]||(g[1]=k=>N(C)?C.value=k:null),disabled:!n.$page.props.workspaces.meta.total},null,8,["checked","disabled"])]),_:1}),e(c,{component:"th",scope:"col"}),e(c,{component:"th",scope:"col"},{default:t(()=>[d(m(s(a)("general.name")),1)]),_:1}),e(c,{component:"th",scope:"col"},{default:t(()=>[d(m(s(a)("general.created_at")),1)]),_:1}),e(c,{component:"th",scope:"col"},{default:t(()=>[d(m(s(a)("user.users")),1)]),_:1}),e(c,{component:"th",scope:"col"})]),_:1})]),body:t(()=>[(l(!0),h(P,null,H(n.$page.props.workspaces.data,k=>(l(),w(De,{key:k.uuid,item:k,onOnDelete:()=>{s(v)(k.uuid)}},{checkbox:t(()=>[e(E,{checked:s(f),"onUpdate:checked":g[2]||(g[2]=K=>N(f)?f.value=K:null),value:k.uuid},null,8,["checked","value"])]),_:2},1032,["item","onOnDelete"]))),128))]),_:1}),n.$page.props.workspaces.meta.total?y("",!0):(l(),w(we,{key:0,table:""}))]),_:1}),n.$page.props.workspaces.meta.links.length>3?(l(),h("div",Te,[e(he,{meta:n.$page.props.workspaces.meta,links:n.$page.props.workspaces.links},null,8,["meta","links"])])):y("",!0)])])],64)}}});export{rt as default};
