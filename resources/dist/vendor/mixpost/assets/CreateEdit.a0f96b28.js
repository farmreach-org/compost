import{u as L,l as O,B as z,T as H,H as M,c as V,a,b as e,e as m,w as s,k as Z,F as T,o as n,Z as G,g as v,f as p,t as c,j as $,h as k,a0 as J,i as K,a1 as Q,ab as R,r as W,bq as X,m as Y,a4 as g,U as j,n as ee}from"./app.17a8bbe4.js";import{u as te}from"./usePostVersions.ae0fd213.js";import{u as ae}from"./Variable.97fafecd.js";import{u as se}from"./useTemplate.87a5a7f9.js";import{_ as oe}from"./PageHeader.cbe4fcaf.js";import{_ as re}from"./Panel.1e5e6be2.js";import{_ as ie}from"./LabelSuffix.fd9b98d2.js";import{_ as le}from"./VerticalGroup.a25bdb43.js";import{a as me,b as ne,c as pe,d as de,e as ue,_ as ce}from"./VariableManager.499eef94.js";import{T as fe}from"./Trash.0f2ffd20.js";import{_ as _e}from"./Flex.4b1efe4e.js";import"./index.92d9ef89.js";import"./index.63dd7c22.js";import"./vue.runtime.esm-bundler.586834b3.js";import"./DropdownItem.409573e1.js";import"./MediaGifs.7235e76d.js";import"./index.browser.89e24408.js";import"./Masonry.f60a1546.js";import"./MediaFile.b8493171.js";import"./ExclamationCircle.dd1367ec.js";import"./SectionTitle.06d0ffc9.js";import"./SearchInput.1ad6cb85.js";import"./NoResult.a422d351.js";import"./Alert.43894852.js";import"./Tab.46ca3863.js";import"./EllipsisVertical.4969c8de.js";import"./PencilSquare.b8b4716b.js";import"./ListItem.7833f353.js";import"./Textarea.21a485eb.js";import"./Badge.82f1358a.js";const xe={class:"w-full mx-auto row-py"},ve={class:"flex"},be={class:"mt-lg row-px w-full"},we=["onSubmit"],ke={for:"template_name"},ge={class:"form-field"},ye={class:"relative flex items-center justify-between border-t border-gray-200 pt-md mt-md"},$e={class:"flex items-center space-x-xs"},et={__name:"CreateEdit",props:["template"],setup(N){const d=N,{t:o}=L(),l=d.template?O.exports.cloneDeep(d.template):null;X("postCtx",{});const f=Y("workspaceCtx"),{notify:b}=ee(),{versionContentObject:B}=te(),{insertEmoji:S,insertContent:y,focusEditor:U}=ae(),{createPost:h,formatTemplateContent:A,deleteTemplate:D}=se(),u=z(!1),_=H({name:l?l.name:"",content:l?l.content:[B()]}),C=M(()=>d.template?o("template.edit_template"):o("template.create_new_template")),w=()=>({name:_.name,content:A(_.content)}),F=()=>{d.template||E(w()),d.template&&P(w())},E=(x,t=!1)=>{g.start(),u.value=!0,axios.post(route("mixpost.templates.api.store",{workspace:f.id}),x).then(r=>{if(b("success",o("template.template_created")),!t){j.get(route("mixpost.templates.edit",{workspace:f.id,template:r.data.id}),{},{preserveScroll:!0});return}j.get(route("mixpost.templates.create",{workspace:f.id}))}).finally(()=>{g.done(),u.value=!1})},P=x=>{g.start(),u.value=!0,axios.put(route("mixpost.templates.api.update",{workspace:f.id,template:d.template.id}),x).then(()=>{b("success",o("template.template_updated"))}).catch(t=>{if(t.response.status!==422){b("error",t.response.data.message);return}b("error",o("template.error_saving_template"))}).finally(()=>{g.done(),u.value=!1})};return(x,t)=>(n(),V(T,null,[a(e(G),{title:e(C)},null,8,["title"]),m("div",xe,[a(oe,{title:e(C)},{default:s(()=>[m("div",ve,[e(l)?(n(),v($,{key:0,onClick:t[0]||(t[0]=()=>{e(h)(w().content)}),class:"mr-xs"},{default:s(()=>[p(c(e(o)("template.use_template")),1)]),_:1})):k("",!0),e(l)?(n(),v(e(K),{key:1,href:x.route("mixpost.templates.create",{workspace:e(f).id})},{default:s(()=>[a(J,{class:"mr-xs"},{default:s(()=>[p(c(e(o)("template.create_new")),1)]),_:1})]),_:1},8,["href"])):k("",!0),e(l)?(n(),v(Q,{key:2,onClick:t[1]||(t[1]=()=>{e(D)(e(l))}),size:"sm"},{default:s(()=>[a(fe)]),_:1})):k("",!0)])]),_:1},8,["title"]),m("div",be,[m("form",{onSubmit:Z(F,["prevent"])},[a(re,null,{title:s(()=>[p(c(e(o)("general.details")),1)]),default:s(()=>[a(le,{class:"mb-lg !max-w-full"},{title:s(()=>[m("label",ke,[p(c(e(o)("template.template_name"))+" ",1),a(ie,{danger:!0},{default:s(()=>[p("*")]),_:1})])]),default:s(()=>[a(R,{type:"text",modelValue:e(_).name,"onUpdate:modelValue":t[2]||(t[2]=r=>e(_).name=r),id:"template_name",required:""},null,8,["modelValue"])]),_:1}),m("div",ge,[(n(!0),V(T,null,W(e(_).content,(r,q)=>(n(),v(ce,{key:q,id:"templateEditor",value:r.body,editable:!0,onUpdate:I=>r.body=I},{default:s(I=>[a(me,{media:r.media},null,8,["media"]),m("div",ye,[m("div",$e,[a(ne,{onSelected:t[3]||(t[3]=i=>e(S)({editorId:"templateEditor",emoji:i})),onClose:t[4]||(t[4]=i=>e(U)({editorId:"templateEditor"}))}),a(pe,{onInsert:i=>{r.media=[...r.media,...i.items],i.crediting&&e(y)({editorId:"templateEditor",text:i.crediting})},selectedAccounts:[],activeVersion:0,versions:[],media:r.media},null,8,["onInsert","media"]),a(de,{editAllowed:!0,onInsert:t[5]||(t[5]=i=>e(y)({editorId:"templateEditor",text:i}))}),a(ue,{editAllowed:!0,onInsert:t[6]||(t[6]=i=>e(y)({editorId:"templateEditor",text:i}))})])])]),_:2},1032,["value","onUpdate"]))),128))]),a(_e,{responsive:!1,class:"items-center mt-lg"},{default:s(()=>[a($,{disabled:u.value,type:"submit",class:"mr-xs"},{default:s(()=>[p(c(e(o)("template.save_template")),1)]),_:1},8,["disabled"]),e(l)?k("",!0):(n(),v($,{key:0,onClick:t[7]||(t[7]=()=>{E(w(),!0)}),disabled:u.value,type:"button"},{default:s(()=>[p(c(e(o)("template.save_create_new")),1)]),_:1},8,["disabled"]))]),_:1})]),_:1})],40,we)])])],64))}};export{et as default};
