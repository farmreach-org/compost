import{u as I,o as i,c as _,F as y,r as S,g as x,a2 as M,a as s,w as e,f as n,t as o,b as t,e as r,h as b,_ as k,j as V,cd as ue,n as F,O as ce,T as H,ab as O,k as le,m as X,a0 as ae,ac as de,B as $,H as me,N as re,a1 as ne,y as K,U as fe,d as _e,Z as pe}from"./app.17a8bbe4.js";import{_ as ve}from"./Minimal.d56ea1c0.js";import{_ as T}from"./Radio.8545682f.js";import{_ as se}from"./Select.86391e44.js";import{_ as oe}from"./Badge.82f1358a.js";import{_ as D}from"./Flex.4b1efe4e.js";import{_ as Q}from"./InputHidden.18513017.js";import{_ as ge}from"./Panel.1e5e6be2.js";import{_ as E}from"./SectionBorder.9e4fdf42.js";import{_ as we}from"./PageHeader.cbe4fcaf.js";import{u as he}from"./useRouter.64f79ca8.js";import{_ as $e}from"./BackToDashboardButton.677591ae.js";import"./UserMenu.1170533d.js";import"./DropdownItem.409573e1.js";import"./Avatar.0b768219.js";import"./PencilSquare.b8b4716b.js";import"./Eye.e20c1588.js";const be=["value"],ye={key:0,class:"text-xs text-gray-500 mt-xs block"},ke={class:"font-medium"},xe=["label"],Ce=["value"],Ve={class:"flex items-center space-x-xs rtl:space-x-reverse"},Le={class:"flex items-center space-x-xs rtl:space-x-reverse"},Se={__name:"Preferences",props:{form:{type:Object,require:!0},locales:{type:Array,required:!0},timezone_list:{type:Object,required:!0}},setup(u){const a=u,g=I(),{t:l}=g,d=w=>a.locales.find(v=>v.long===w).direction||"ltr",h=w=>!["en-GB","fr-CA","ar-SA","de-DE","es-MX"].includes(w),{notify:c}=F(),m=()=>{a.form.put(route("mixpost.profile.updatePreferences"),{preserveScroll:!0,onSuccess(){ue.changeLocale(g,a.form.locale,d(a.form.locale)),c("success",l("profile.preferences_updated"))}})};return(w,v)=>(i(),_("div",null,[(i(!0),_(y,null,S(u.form.errors,f=>(i(),x(M,{message:f,class:"mb-xs"},null,8,["message"]))),256)),s(k,null,{title:e(()=>[n(o(t(l)("general.language")),1)]),default:e(()=>[r("div",null,[s(se,{modelValue:u.form.locale,"onUpdate:modelValue":v[0]||(v[0]=f=>u.form.locale=f)},{default:e(()=>[(i(!0),_(y,null,S(u.locales,f=>(i(),_("option",{value:f.long},o(f.english)+" - "+o(f.native)+" - ("+o(f.long)+") "+o(h(f.long)?"[Beta]":""),9,be))),256))]),_:1},8,["modelValue"]),h(u.form.locale)?(i(),_("span",ye,[n(" \u{1F6A7} Language "),r("span",ke,o(u.form.locale),1),n(" is in beta and may not be fully translated or can contain errors. ")])):b("",!0)])]),_:1}),s(k,{class:"mt-lg"},{title:e(()=>[n(o(t(l)("general.timezone")),1)]),default:e(()=>[r("div",null,[s(se,{modelValue:u.form.timezone,"onUpdate:modelValue":v[1]||(v[1]=f=>u.form.timezone=f)},{default:e(()=>[(i(!0),_(y,null,S(u.timezone_list,(f,L)=>(i(),_("optgroup",{label:L},[(i(!0),_(y,null,S(f,(P,U)=>(i(),_("option",{value:U},o(P),9,Ce))),256))],8,xe))),256))]),_:1},8,["modelValue"])])]),_:1}),s(k,{class:"mt-lg"},{title:e(()=>[n(o(t(l)("profile.time_format")),1)]),default:e(()=>[r("div",Ve,[r("label",null,[s(T,{checked:u.form.time_format,"onUpdate:checked":v[2]||(v[2]=f=>u.form.time_format=f),value:12},null,8,["checked"]),n(" 12 "+o(t(l)("profile.hour")),1)]),r("label",null,[s(T,{checked:u.form.time_format,"onUpdate:checked":v[3]||(v[3]=f=>u.form.time_format=f),value:24},null,8,["checked"]),n(" 24 "+o(t(l)("profile.hour")),1)])])]),_:1}),s(k,{class:"mt-lg"},{title:e(()=>[n(o(t(l)("profile.first_day_week")),1)]),default:e(()=>[r("div",Le,[r("label",null,[s(T,{checked:u.form.week_starts_on,"onUpdate:checked":v[4]||(v[4]=f=>u.form.week_starts_on=f),value:0},null,8,["checked"]),n(" "+o(t(l)("profile.sunday")),1)]),r("label",null,[s(T,{checked:u.form.week_starts_on,"onUpdate:checked":v[5]||(v[5]=f=>u.form.week_starts_on=f),value:1},null,8,["checked"]),n(" "+o(t(l)("profile.monday")),1)])])]),_:1}),s(V,{onClick:m,class:"mt-lg"},{default:e(()=>[n(o(t(l)("general.save")),1)]),_:1})]))}},Pe=["onSubmit"],Ue={for:"name"},Ae={for:"email"},ze={__name:"UserAccount",setup(u){const{t:a}=I(),{user:g}=ce(),{notify:l}=F(),d=H({name:g.value.name,email:g.value.email}),h=()=>{d.put(route("mixpost.profile.updateUser"),{preserveScroll:!0,onSuccess(){l("success",a("account.account_updated"))}})};return(c,m)=>(i(),_("form",{onSubmit:le(h,["prevent"])},[(i(!0),_(y,null,S(t(d).errors,w=>(i(),x(M,{message:w,class:"mb-xs"},null,8,["message"]))),256)),s(k,null,{title:e(()=>[r("label",Ue,o(t(a)("general.name")),1)]),default:e(()=>[s(O,{type:"text",modelValue:t(d).name,"onUpdate:modelValue":m[0]||(m[0]=w=>t(d).name=w),error:t(d).errors.name,id:"name"},null,8,["modelValue","error"])]),_:1}),s(k,{class:"mt-lg"},{title:e(()=>[r("label",Ae,o(t(a)("general.email")),1)]),default:e(()=>[s(O,{type:"email",modelValue:t(d).email,"onUpdate:modelValue":m[1]||(m[1]=w=>t(d).email=w),error:t(d).errors.email,id:"email"},null,8,["modelValue","error"])]),_:1}),s(V,{type:"submit",class:"mt-lg"},{default:e(()=>[n(o(t(a)("general.save")),1)]),_:1})],40,Pe))}},Ie={for:"password"},Be={__name:"ConfirmPassword",props:{show:{type:Boolean,default:!0}},emits:["close","confirm"],setup(u,{emit:a}){const g=X("routePrefix"),l=()=>{a("close")},d=H({password:""}),h=()=>{d.post(route(`${g}.profile.confirmPassword`),{preserveScroll:!0,onSuccess(){a("confirm"),d.reset(),l()}})};return(c,m)=>(i(),x(de,{show:u.show,"max-width":"lg",closeable:!0,"scrollable-body":!0,zIndexClass:"z-30",onClose:l},{header:e(()=>[n(o(c.$t("auth.confirm_password")),1)]),body:e(()=>[u.show?(i(),_(y,{key:0},[r("div",null,o(c.$t("profile.security_confirm_password")),1),s(k,{class:"mt-lg"},{title:e(()=>[r("label",Ie,o(c.$t("auth.password")),1)]),footer:e(()=>[s(M,{message:t(d).errors.password},null,8,["message"])]),default:e(()=>[s(O,{modelValue:t(d).password,"onUpdate:modelValue":m[0]||(m[0]=w=>t(d).password=w),error:t(d).errors.password,type:"password",id:"password",class:"w-full",autocomplete:"password"},null,8,["modelValue","error"])]),_:1})],64)):b("",!0)]),footer:e(()=>[s(ae,{onClick:l,class:"mr-xs"},{default:e(()=>[n(o(c.$t("general.cancel")),1)]),_:1}),s(V,{onClick:h,disabled:t(d).processing,isLoading:t(d).processing,class:"mr-xs"},{default:e(()=>[n(o(c.$t("general.confirm")),1)]),_:1},8,["disabled","isLoading"])]),_:1},8,["show"]))}},je={class:"mt-lg"},Re={key:0,class:"mt-lg"},qe=["innerHTML"],Ne={class:"uppercase font-medium text-center"},Te={class:"text-gray-500"},De={class:"mt-md"},Ee={for:"code"},Oe={key:1},Me={key:0,class:"mt-lg"},Fe={class:"mt-xs bg-primary-50 rounded-lg p-md"},He={class:"mb-xs"},Ge={class:"font-medium"},Ke={__name:"TwoFactorAuth",setup(u){const{t:a}=I(),g=$({svg:"",secret_key:""}),l=$(!1),d=$(!1),h=$(""),c=$(!1),m=$(!1),w=$([]),v=$(!1),f=$(null),L=X("routePrefix"),{notify:P}=F(),U=me(()=>d.value?!1:re().props.user_has_two_factor_auth_enabled||l.value===!0),ie=()=>{v.value=!0},Z=()=>{v.value=!1},B=$(!1),J=()=>{B.value=!0,axios.post(route(`${L}.profile.two-factor-auth.enable`)).then(p=>{c.value=!0,g.value=p.data}).catch(p=>A(p,J)).finally(()=>B.value=!1)},j=$(!1),W=()=>{j.value=!0,axios.post(route(`${L}.profile.two-factor-auth.confirm`),{code:h.value}).then(p=>{l.value=!0,d.value=!1,c.value=!1,w.value=p.data.recovery_codes,m.value=!0,h.value="",P("success",a("profile.two_factor_enabled"))}).catch(p=>A(p,W)).finally(()=>j.value=!1)},R=$(!1),Y=()=>{R.value=!0,axios.get(route(`${L}.profile.two-factor-auth.showRecoveryCodes`)).then(p=>{w.value=p.data.recovery_codes,m.value=!0}).catch(p=>A(p,Y)).finally(()=>R.value=!1)},q=$(!1),ee=()=>{q.value=!0,axios.post(route(`${L}.profile.two-factor-auth.regenerateRecoveryCodes`)).then(p=>{w.value=p.data.recovery_codes,m.value=!0}).catch(p=>A(p,ee)).finally(()=>q.value=!1)},N=$(!1),te=()=>{N.value=!0,axios.delete(route(`${L}.profile.two-factor-auth.disable`)).then(()=>{d.value=!0,P("success",a("profile.two_factor_disabled"))}).catch(p=>A(p,te)).finally(()=>N.value=!1)},A=(p,C)=>{if(p.response.status===422){p.response.data.errors.confirm_password&&(f.value=C,ie()),p.response.data.errors.code&&P("error",p.response.data.errors.code[0]);return}P("error",a("error.something_wrong"))};return(p,C)=>(i(),_(y,null,[r("div",null,[r("div",null,o(t(a)("profile.install_totp")),1),r("div",je,[t(U)?(i(),x(oe,{key:0,variant:"success"},{default:e(()=>[n(o(t(a)("general.enabled")),1)]),_:1})):b("",!0),t(U)?b("",!0):(i(),x(oe,{key:1,variant:"error"},{default:e(()=>[n(o(t(a)("general.disabled")),1)]),_:1}))]),c.value?(i(),_("div",Re,[s(D,{class:"w-full relative rounded-lg border border-gray-200 p-xs"},{default:e(()=>[r("div",{innerHTML:g.value.svg},null,8,qe),s(D,{class:"justify-center items-center w-full"},{default:e(()=>[r("div",Ne,[r("div",Te,o(t(a)("profile.secret_key")),1),r("div",null,o(g.value.secret_key),1)])]),_:1})]),_:1}),r("div",De,o(t(a)("profile.scan_qr_code")),1),s(k,{class:"mt-lg"},{title:e(()=>[r("label",Ee,o(t(a)("profile.code")),1)]),default:e(()=>[s(O,{modelValue:h.value,"onUpdate:modelValue":C[0]||(C[0]=G=>h.value=G),type:"text",id:"code",class:"w-full",autocomplete:"off"},null,8,["modelValue"])]),_:1}),s(D,null,{default:e(()=>[s(V,{onClick:W,disabled:j.value,isLoading:j.value,class:"mt-lg"},{default:e(()=>[n(o(t(a)("general.confirm")),1)]),_:1},8,["disabled","isLoading"]),s(ae,{onClick:C[1]||(C[1]=()=>{c.value=!1,h.value=""}),class:"mt-lg"},{default:e(()=>[n(o(t(a)("general.cancel")),1)]),_:1})]),_:1})])):b("",!0),t(U)?(i(),_("div",Oe,[m.value?(i(),_("div",Me,[r("div",null,o(t(a)("profile.store_recovery_codes")),1),r("div",Fe,[(i(!0),_(y,null,S(w.value,G=>(i(),_("div",He,[r("div",Ge,o(G),1)]))),256))])])):b("",!0),s(D,{class:"mt-lg"},{default:e(()=>[m.value?(i(),x(V,{key:0,onClick:ee,disabled:q.value,isLoading:q.value},{default:e(()=>[n(o(t(a)("profile.regenerate_recovery_codes")),1)]),_:1},8,["disabled","isLoading"])):b("",!0),m.value?b("",!0):(i(),x(V,{key:1,onClick:Y,disabled:R.value,isLoading:R.value},{default:e(()=>[n(o(t(a)("profile.show_recovery_codes")),1)]),_:1},8,["disabled","isLoading"])),s(ne,{onClick:te,disabled:N.value,isLoading:N.value},{default:e(()=>[n(o(t(a)("general.disable")),1)]),_:1},8,["disabled","isLoading"])]),_:1})])):b("",!0),!t(U)&&!c.value?(i(),x(V,{key:2,onClick:J,disabled:B.value,isLoading:B.value,class:"mt-lg"},{default:e(()=>[n(o(t(a)("general.enable")),1)]),_:1},8,["disabled","isLoading"])):b("",!0)]),s(Be,{show:v.value,onConfirm:C[2]||(C[2]=()=>{Z(),f.value&&f.value()}),onClose:Z},null,8,["show"])],64))}},Qe=["onSubmit"],Xe={for:"current_password"},Ze={for:"password"},Je={for:"password_confirmation"},We={__name:"Password",setup(u){const{t:a}=I(),{notify:g}=F(),l=H({current_password:"",password:"",password_confirmation:""}),d=()=>{l.put(route("mixpost.profile.updatePassword"),{preserveScroll:!0,onSuccess(){l.reset(),g("success",a("profile.password_changed"))}})};return(h,c)=>(i(),_("form",{onSubmit:le(d,["prevent"])},[(i(!0),_(y,null,S(t(l).errors,m=>(i(),x(M,{message:m,class:"mb-xs"},null,8,["message"]))),256)),s(k,{class:"mt-lg"},{title:e(()=>[r("label",Xe,o(t(a)("profile.current_password")),1)]),default:e(()=>[s(Q,{modelValue:t(l).current_password,"onUpdate:modelValue":c[0]||(c[0]=m=>t(l).current_password=m),error:t(l).errors.current_password,id:"current_password",required:""},null,8,["modelValue","error"])]),_:1}),s(k,{class:"mt-md"},{title:e(()=>[r("label",Ze,o(t(a)("profile.new_password")),1)]),default:e(()=>[s(Q,{modelValue:t(l).password,"onUpdate:modelValue":c[1]||(c[1]=m=>t(l).password=m),error:t(l).errors.password,id:"password",autocomplete:"new-password",required:""},null,8,["modelValue","error"])]),_:1}),s(k,{class:"mt-md"},{title:e(()=>[r("label",Je,o(t(a)("profile.confirm_new_password")),1)]),default:e(()=>[s(Q,{modelValue:t(l).password_confirmation,"onUpdate:modelValue":c[2]||(c[2]=m=>t(l).password_confirmation=m),error:t(l).password_confirmationpassword,id:"password_confirmation",autocomplete:"new-password",required:""},null,8,["modelValue","error"])]),_:1}),s(V,{type:"submit",class:"mt-lg"},{default:e(()=>[n(o(t(a)("general.save")),1)]),_:1})],40,Qe))}},Ye={class:"md:grid md:grid-cols-3 md:gap-lg"},et={class:"md:col-span-1 flex justify-between"},tt={class:"text-lg font-medium text-gray-900"},st={class:"mt-xs text-gray-500"},ot={class:"mt-lg md:mt-0 md:col-span-2"},z={__name:"ActionSection",setup(u){return(a,g)=>(i(),_("div",Ye,[r("div",et,[r("div",null,[r("h3",tt,[K(a.$slots,"title")]),r("p",st,[K(a.$slots,"description")])])]),r("div",ot,[s(ge,null,{default:e(()=>[K(a.$slots,"default")]),_:3})])]))}},lt={__name:"DeleteAccount",setup(u){const{t:a}=I(),g=X("confirmation"),{onError:l}=he(),d=()=>{g().title(a("profile.delete_account")).description(a("profile.delete_account_desc")).destructive().btnConfirmName(a("profile.delete_account")).onConfirm(c=>{c.isLoading(!0),h(c)}).show()},h=c=>{fe.delete(re().props.delete_account_url,{onSuccess(){c.reset()},onError(m){c.isLoading(!1),l(m,()=>{c.isLoading(!0),h(c)})}})};return(c,m)=>(i(),x(ne,{onClick:d},{default:e(()=>[n(o(t(a)("profile.delete_account")),1)]),_:1}))}},at={class:"row-py w-full mx-auto !pt-0"},rt={class:"w-full mb-lg"},nt={class:"mt-2xl sm:mt-0"},it={class:"mt-2xl sm:mt-0"},ut={class:"mt-2xl sm:mt-0"},ct={class:"mt-2xl sm:mt-0"},dt={class:"mt-2xl sm:mt-0"},mt=_e({layout:ve}),Ut=Object.assign(mt,{__name:"Profile",props:["settings","locales","timezone_list","user_has_two_factor_auth_enabled","is_delete_account_enabled"],setup(u){const g=H(u.settings);return(l,d)=>(i(),_(y,null,[s(t(pe),{title:l.$t("profile.edit_profile")},null,8,["title"]),s(we,{title:l.$t("profile.edit_profile"),class:"!px-0"},{default:e(()=>[s($e)]),_:1},8,["title"]),r("div",at,[r("div",rt,[r("div",nt,[s(z,null,{title:e(()=>[n(o(l.$t("profile.profile_information")),1)]),description:e(()=>[n(o(l.$t("profile.update_your_account")),1)]),default:e(()=>[s(ze)]),_:1})]),s(E,{contrasted:!0}),r("div",it,[s(z,null,{title:e(()=>[n(o(l.$t("profile.preferences")),1)]),description:e(()=>[n(o(l.$t("profile.update_preferences")),1)]),default:e(()=>[s(Se,{form:t(g),timezone_list:u.timezone_list,locales:u.locales},null,8,["form","timezone_list","locales"])]),_:1})]),l.$page.props.is_two_factor_auth_enabled?(i(),_(y,{key:0},[s(E,{contrasted:!0}),r("div",ut,[s(z,null,{title:e(()=>[n(o(l.$t("auth.two_factor_authentication")),1)]),description:e(()=>[n(o(l.$t("auth.security_using_two_factor")),1)]),default:e(()=>[s(Ke)]),_:1})])],64)):b("",!0),s(E,{contrasted:!0}),r("div",ct,[s(z,null,{title:e(()=>[n(o(l.$t("auth.update_password")),1)]),description:e(()=>[n(o(l.$t("auth.confirm_secure_password")),1)]),default:e(()=>[s(We)]),_:1})]),u.is_delete_account_enabled?(i(),_(y,{key:1},[s(E,{contrasted:!0}),r("div",dt,[s(z,null,{title:e(()=>[n(o(l.$t("profile.delete_account")),1)]),description:e(()=>[n(o(l.$t("profile.delete_account_desc")),1)]),default:e(()=>[s(lt)]),_:1})])],64)):b("",!0)])])],64))}});export{Ut as default};
