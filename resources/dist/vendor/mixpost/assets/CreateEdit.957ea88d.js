import{u as O,l as q,I as z,T as M,N as R,c as V,a,b as e,e as m,w as s,k as Z,F as N,o as n,Z as G,g as v,f as d,t as c,j as $,h as k,R as H,i as J,U as K,aa as Q,r as W,bw as X,m as Y,a0 as g,ak as T,n as ee}from"./app.af17fce1.js";import{u as te}from"./usePostVersions.ae0fd213.js";import{u as ae}from"./Variable.14bfdb1f.js";import{u as se}from"./useTemplate.68411b5c.js";import{_ as oe}from"./PageHeader.fa50e47e.js";import{_ as re}from"./Panel.46137120.js";import{_ as ie}from"./LabelSuffix.b035370b.js";import{_ as le}from"./VerticalGroup.52259a52.js";import{a as me,b as ne,c as de,d as pe,e as ue,_ as ce}from"./VariableManager.b3ee3513.js";import{T as fe}from"./Trash.ee5d54c5.js";import{_ as _e}from"./Flex.16a0de6f.js";import"./index.1e577897.js";import"./index.67c8fd0f.js";import"./vue.runtime.esm-bundler.e6f20297.js";import"./MediaGifs.04f762c3.js";import"./index.browser.89e24408.js";import"./Masonry.89e32a10.js";import"./MediaFile.bd3acf0a.js";import"./ExclamationCircle.2dc7440a.js";import"./SectionTitle.1b751bda.js";import"./SearchInput.1d1bce1a.js";import"./NoResult.ab0b21a6.js";import"./Alert.4b0fccab.js";import"./Tab.319f1bf2.js";import"./EllipsisVertical.42e3e8f4.js";import"./ListItem.f6ce595c.js";import"./Textarea.6ba3949b.js";const xe={class:"w-full mx-auto row-py"},ve={class:"flex"},we={class:"mt-lg row-px w-full"},be=["onSubmit"],ke={for:"template_name"},ge={class:"form-field"},ye={class:"relative flex items-center justify-between border-t border-gray-200 pt-md mt-md"},$e={class:"flex items-center space-x-xs"},We={__name:"CreateEdit",props:["template"],setup(j){const p=j,{t:o}=O(),l=p.template?q.exports.cloneDeep(p.template):null;X("postCtx",{});const f=Y("workspaceCtx"),{notify:w}=ee(),{versionContentObject:S}=te(),{insertEmoji:B,insertContent:y,focusEditor:U}=ae(),{createPost:h,formatTemplateContent:A,deleteTemplate:D}=se(),u=z(!1),_=M({name:l?l.name:"",content:l?l.content:[S()]}),C=R(()=>p.template?o("template.edit_template"):o("template.create_new_template")),b=()=>({name:_.name,content:A(_.content)}),F=()=>{p.template||I(b()),p.template&&P(b())},I=(x,t=!1)=>{g.start(),u.value=!0,axios.post(route("mixpost.templates.api.store",{workspace:f.id}),x).then(r=>{if(w("success",o("template.template_created")),!t){T.get(route("mixpost.templates.edit",{workspace:f.id,template:r.data.id}),{},{preserveScroll:!0});return}T.get(route("mixpost.templates.create",{workspace:f.id}))}).finally(()=>{g.done(),u.value=!1})},P=x=>{g.start(),u.value=!0,axios.put(route("mixpost.templates.api.update",{workspace:f.id,template:p.template.id}),x).then(()=>{w("success",o("template.template_updated"))}).catch(t=>{if(t.response.status!==422){w("error",t.response.data.message);return}w("error",o("template.error_saving_template"))}).finally(()=>{g.done(),u.value=!1})};return(x,t)=>(n(),V(N,null,[a(e(G),{title:e(C)},null,8,["title"]),m("div",xe,[a(oe,{title:e(C)},{default:s(()=>[m("div",ve,[e(l)?(n(),v($,{key:0,onClick:t[0]||(t[0]=()=>{e(h)(b().content)}),class:"mr-xs"},{default:s(()=>[d(c(e(o)("template.use_template")),1)]),_:1})):k("",!0),e(l)?(n(),v(e(J),{key:1,href:x.route("mixpost.templates.create",{workspace:e(f).id})},{default:s(()=>[a(H,{class:"mr-xs"},{default:s(()=>[d(c(e(o)("template.create_new")),1)]),_:1})]),_:1},8,["href"])):k("",!0),e(l)?(n(),v(K,{key:2,onClick:t[1]||(t[1]=()=>{e(D)(e(l))}),size:"sm"},{default:s(()=>[a(fe)]),_:1})):k("",!0)])]),_:1},8,["title"]),m("div",we,[m("form",{onSubmit:Z(F,["prevent"])},[a(re,null,{title:s(()=>[d(c(e(o)("general.details")),1)]),default:s(()=>[a(le,{class:"mb-lg !max-w-full"},{title:s(()=>[m("label",ke,[d(c(e(o)("template.template_name"))+" ",1),a(ie,{danger:!0},{default:s(()=>[d("*")]),_:1})])]),default:s(()=>[a(Q,{type:"text",modelValue:e(_).name,"onUpdate:modelValue":t[2]||(t[2]=r=>e(_).name=r),id:"template_name",required:""},null,8,["modelValue"])]),_:1}),m("div",ge,[(n(!0),V(N,null,W(e(_).content,(r,L)=>(n(),v(ce,{key:L,id:"templateEditor",value:r.body,editable:!0,onUpdate:E=>r.body=E},{default:s(E=>[a(me,{media:r.media},null,8,["media"]),m("div",ye,[m("div",$e,[a(ne,{onSelected:t[3]||(t[3]=i=>e(B)({editorId:"templateEditor",emoji:i})),onClose:t[4]||(t[4]=i=>e(U)({editorId:"templateEditor"}))}),a(de,{onInsert:i=>{r.media=[...r.media,...i.items],i.crediting&&e(y)({editorId:"templateEditor",text:i.crediting})},selectedAccounts:[],activeVersion:0,versions:[],media:r.media},null,8,["onInsert","media"]),a(pe,{editAllowed:!0,onInsert:t[5]||(t[5]=i=>e(y)({editorId:"templateEditor",text:i}))}),a(ue,{editAllowed:!0,onInsert:t[6]||(t[6]=i=>e(y)({editorId:"templateEditor",text:i}))})])])]),_:2},1032,["value","onUpdate"]))),128))]),a(_e,{responsive:!1,class:"items-center mt-lg"},{default:s(()=>[a($,{disabled:u.value,type:"submit",class:"mr-xs"},{default:s(()=>[d(c(e(o)("template.save_template")),1)]),_:1},8,["disabled"]),e(l)?k("",!0):(n(),v($,{key:0,onClick:t[7]||(t[7]=()=>{I(b(),!0)}),disabled:u.value,type:"button"},{default:s(()=>[d(c(e(o)("template.save_create_new")),1)]),_:1},8,["disabled"]))]),_:1})]),_:1})],40,be)])])],64))}};export{We as default};
